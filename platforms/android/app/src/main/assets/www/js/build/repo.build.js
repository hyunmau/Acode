"use strict";(self.webpackChunkcom_foxdebug_acode=self.webpackChunkcom_foxdebug_acode||[]).push([[150],{41097:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var n=r(7449),a=r(76972),s=r.n(a),i=r(89184),c=r.n(i),o=r(30011),l=r(87771),u=r(71530),d=r(23324),p=r(17886),h=r(75453),f=r(64413);function m(e,t){var r,a,i=c().parse("<div class='main' id='repo-tree'>\r\n  <div class='navigation'></div>\r\n</div>"),m=i.querySelector(".navigation"),g=h.Z.GitHub().getRepo(e,t),v=c()("span",{className:"icon search",attr:{action:"search"}}),b={"/":{name:"/",sha:"/",list:[]}},k={list:[],name:"",sha:"",scroll:0},x=[],Z={id:"from",placeholder:strings["use branch"],hints:function(e){e(x.slice(0,-1))},type:"text"},y={id:"branch",placeholder:strings["new branch"],type:"text",match:/^[a-z\-_0-9]+$/i},w=[],F=!1;function S(){p.Z.loader.create(t,strings.loading+"..."),g.getSha(a,"").then((function(e){var n=_(e.data);r=(0,u.Z)(t+" (".concat(a,")"),{lead:c()("span",{className:"icon clearclose",attr:{action:"close"}})}),b["/"].list=n,B("/","/"),r.addEventListener("click",L),r.body=i,r.header.append(v),app.append(r),d.Z.showAd(),actionStack.setMark(),actionStack.push({id:"repo",action:r.hide}),r.onhide=function(){d.Z.hideAd(F),actionStack.pop(),r.removeEventListener("click",L),actionStack.clearFromMark(),actionStack.remove("repo")}})).catch((function(e){d.Z.error(e)})).finally((function(){p.Z.loader.destroy()}))}function L(c){var o=c.target,u=o.getAttribute("action");u&&function(c,o){var u=o.getAttribute("sha"),h=o.getAttribute("name");switch(c){case"close":r.hide();break;case"navigate":B(h,u);break;case"file":!function(){m.apply(this,arguments)}();break;case"search":(0,f.Z)(i.get(".list"))}function m(){return(m=(0,n.Z)(s().mark((function n(){var i,c,o,f,m,v;return s().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,d.Z.showTitleLoader(),i=d.Z.extname(h),c=l.lookup(i),o=/image/i.test(c)?"image":null,n.next=7,g.getBlob(u,"blob");case 7:if(f=n.sent,m=f.data,"image"!==o){n.next=12;break}return p.Z.box(h,"<img src='".concat(URL.createObjectURL(m),"'>")),n.abrupt("return");case 12:if(!(m instanceof Blob)){n.next=29;break}if(n.prev=13,!m.text){n.next=20;break}return n.next=17,m.text();case 17:m=n.sent,n.next=23;break;case 20:return n.next=22,d.Z.blob2text(m);case 22:m=n.sent;case 23:n.next=29;break;case 25:n.prev=25,n.t0=n.catch(13),console.error(n.t0),p.Z.alert(strings.error,strings["unable to open file"]);case 29:v=gitRecord.add({sha:u,data:m,name:h,branch:a,repo:t,path:w.slice(1).join("/"),owner:e}),F=!0,editorManager.addNewFile(h,{type:"git",record:v,text:m,isUnsaved:!1}),r.hide(),n.next=38;break;case 35:n.prev=35,n.t1=n.catch(0),z(n.t1);case 38:return n.prev=38,d.Z.removeTitleLoader(),n.finish(38);case 41:case"end":return n.stop()}}),n,null,[[0,35,38,41],[13,25]])})))).apply(this,arguments)}}(u,o)}function A(e){var t=e.list,r=e.scroll,n=void 0===r?0:r,a=i.get(".list");a&&a.remove();var s=c().parse(o.Z.render('<div class="list" id="repo-list" empty-message="{{msg}}">{{#list}}{{#.}}\r\n  <div class="list-item" sha="{{sha}}" name="{{name}}"\r\n    action="{{#isDirectory}}navigate{{/isDirectory}}{{#isFile}}file{{/isFile}}">\r\n    <span class="icon {{icon}}"></span>\r\n    <span class="container">\r\n      <div class="text">\r\n        <span>{{name}}</span>\r\n      </div>\r\n      {{#isFile}}\r\n      <small class="value">{{size}}</small>\r\n      {{/isFile}}\r\n    </span>\r\n  </div>\r\n  {{/.}}{{/list}}\r\n</div>',{msg:strings["empty folder message"],list:t}));i.append(s),s.scrollTop=n}function B(e,t){return D.apply(this,arguments)}function D(){return(D=(0,n.Z)(s().mark((function e(t,r){var n,a,o,l,u,d,p,h,f,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=m.get('[sha="'.concat(r,'"]')))){e.next=13;break}for(o=null;(a=m.lastChild)!==n;)l=a.getAttribute("sha"),actionStack.remove(l),a.remove(),w.pop(),o&&o in b&&delete b[o],o=l;return e.next=6,N(t,r);case 6:if(!(u=e.sent)){e.next=11;break}return A(u),k=u,e.abrupt("return");case 11:return A({list:[],scroll:0}),e.abrupt("return");case 13:return e.next=15,N(t,r);case 15:(d=e.sent)&&((p=i.get(".list"))&&(k.scroll=p.scrollTop),w.push(t),m.append(c()("span",{className:"nav",attr:{sha:r,action:"navigate",text:t,name:t}})),m.scrollLeft=m.scrollWidth,f=(h=k).sha,g=h.name,f&&g&&actionStack.push({id:r,action:function(){B(g,f)}}),A(d),b[r]=d,k=d);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t){return T.apply(this,arguments)}function T(){return(T=(0,n.Z)(s().mark((function e(r,n){var a,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n in b)){e.next=2;break}return e.abrupt("return",b[n]);case 2:return a=null,p.Z.loader.create(t,strings.loading+"..."),e.prev=4,e.next=7,g.getTree(n);case 7:i=e.sent,c=_(c=i.data.tree),a={list:c,name:r,sha:n,scroll:0},e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),z(e.t0);case 16:return p.Z.loader.destroy(),e.abrupt("return",a);case 18:case"end":return e.stop()}}),e,null,[[4,13]])})))).apply(this,arguments)}function _(e){return e.map((function(e){var t=e.size,r=e.type;e.size=(t/1024).toFixed(2)+"KB",!e.name&&e.path&&(e.name=e.path),e.isDirectory="dir"===r||"tree"===r,e.isFile=!e.isDirectory,e.type=e.isDirectory?"folder":d.Z.getIconForFile(e.name)})),d.Z.sortDir(e,{showHiddenFiles:"on",sortByName:"on"})}function z(e){console.error(e),actionStack.pop(),p.Z.alert(strings.error,e.toString())}p.Z.loader.create(t,strings.loading+"..."),g.listBranches().then((function(e){return p.Z.loader.destroy(),e.data.map((function(e){return x.push(e.name)})),x.push(["add",strings["new branch"],"add"]),p.Z.select(strings["select branch"],x)})).then((function(e){"add"===e?p.Z.multiPrompt(strings["create new branch"],[Z,y]).then((function(e){var t=e.from;return a=e.branch,p.Z.loader.create("",strings.loading+"..."),g.createBranch(t,a)})).then(S).catch((function(e){d.Z.error(e)})).finally((function(){p.Z.loader.destroy()})):(a=e,S())})).catch((function(e){d.Z.error(e),p.Z.loader.destroy()}))}}}]);